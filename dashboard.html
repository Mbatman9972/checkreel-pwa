<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CheckReel Dashboard</title>
<link rel="icon" type="image/x-icon" href="images/favicon.ico">
<link rel="manifest" href="manifest.json">
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
background: linear-gradient(135deg, #1e3c72 0%, #2a5298 25%, #667eea 50%, #764ba2 75%, #8e44ad 100%);
min-height: 100vh;
color: #333;
}

.container {
max-width: 1200px;
margin: 0 auto;
padding: 20px;
}

/* Header */
.header {
display: flex;
justify-content: space-between;
align-items: center;
background: rgba(255, 255, 255, 0.95);
backdrop-filter: blur(10px);
padding: 15px 30px;
border-radius: 15px;
margin-bottom: 30px;
box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.logo-section {
display: flex;
align-items: center;
gap: 15px;
}

.logo-img {
width: 45px;
height: 45px;
border-radius: 10px;
}

.logo-text {
font-size: 24px;
font-weight: bold;
background: linear-gradient(45deg, #1e3c72, #667eea);
-webkit-background-clip: text;
-webkit-text-fill-color: transparent;
background-clip: text;
}

.user-section {
display: flex;
align-items: center;
gap: 20px;
}

.tier-badge {
padding: 8px 16px;
border-radius: 20px;
font-size: 12px;
font-weight: 600;
text-transform: uppercase;
letter-spacing: 0.5px;
}

.tier-free { background: #e3f2fd; color: #1976d2; }
.tier-plus { background: #f3e5f5; color: #7b1fa2; }
.tier-premium { background: #fff3e0; color: #f57c00; }

/* Tier Selection */
.tier-selection {
background: rgba(255, 255, 255, 0.95);
backdrop-filter: blur(10px);
border-radius: 20px;
padding: 25px;
margin-bottom: 20px;
box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.tier-plans {
display: grid;
grid-template-columns: repeat(3, 1fr);
gap: 15px;
margin-top: 15px;
}

.tier-plan {
background: white;
border: 2px solid #e0e0e0;
border-radius: 15px;
padding: 20px;
text-align: center;
cursor: pointer;
transition: all 0.3s ease;
position: relative;
}

.tier-plan:hover {
transform: translateY(-3px);
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
}

.tier-plan.active {
border-color: #1e3c72;
background: linear-gradient(135deg, #1e3c72 0%, #667eea 100%);
color: white;
}

.tier-plan.recommended {
border-color: #ff6b6b;
}

.tier-plan.recommended::before {
content: "RECOMMENDED";
position: absolute;
top: -10px;
left: 50%;
transform: translateX(-50%);
background: #ff6b6b;
color: white;
padding: 4px 12px;
border-radius: 12px;
font-size: 10px;
font-weight: bold;
}

.tier-name {
font-size: 16px;
font-weight: bold;
margin-bottom: 8px;
}

.tier-price {
font-size: 18px;
font-weight: bold;
color: #1e3c72;
margin-bottom: 8px;
}

.tier-plan.active .tier-price {
color: white;
}

.tier-scans {
font-size: 12px;
opacity: 0.8;
margin-bottom: 10px;
}

.tier-features {
font-size: 11px;
opacity: 0.9;
line-height: 1.4;
}

/* Alert - MOVED BELOW TIER SELECTION */
.selection-alert {
background: linear-gradient(135deg, #ff6b6b, #ff8e8e);
color: white;
padding: 15px 25px;
border-radius: 10px;
margin-bottom: 20px;
text-align: center;
font-weight: 600;
box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
}

.selection-alert.hidden {
display: none;
}

/* Main Content */
.dashboard-grid {
display: grid;
grid-template-columns: 1fr 1fr 1fr;
gap: 20px;
margin-bottom: 30px;
}

.card {
background: rgba(255, 255, 255, 0.95);
backdrop-filter: blur(10px);
border-radius: 20px;
padding: 25px;
box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
}

.card h2 {
margin-bottom: 20px;
color: #333;
display: flex;
align-items: center;
gap: 10px;
font-size: 18px;
}

/* Region Selection */
.region-grid {
display: grid;
grid-template-columns: repeat(2, 1fr);
gap: 10px;
margin-bottom: 15px;
}

.region-option {
display: flex;
flex-direction: column;
align-items: center;
padding: 15px;
border: 2px solid #e0e0e0;
border-radius: 12px;
cursor: pointer;
transition: all 0.3s ease;
background: white;
text-align: center;
}

.region-option:hover {
transform: translateY(-2px);
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
}

.region-option.selected {
border-color: #1e3c72;
background: linear-gradient(135deg, #1e3c72 0%, #667eea 100%);
color: white;
animation: glowPulse 2s infinite ease-in-out;
}

@keyframes glowPulse {
0%, 100% {
box-shadow: 0 0 20px rgba(30, 60, 114, 0.7);
}
50% {
box-shadow: 0 0 30px rgba(30, 60, 114, 1), 0 0 40px rgba(102, 126, 234, 0.8);
}
}

.region-icon {
width: 35px;
height: 35px;
margin-bottom: 8px;
border-radius: 6px;
object-fit: cover;
}

.region-name {
font-size: 12px;
font-weight: 600;
}

/* Platform Selection */
.platforms-grid {
display: grid;
grid-template-columns: repeat(3, 1fr);
gap: 12px;
}

.platform-option {
display: flex;
flex-direction: column;
align-items: center;
padding: 15px;
border: 2px solid #e0e0e0;
border-radius: 12px;
cursor: pointer;
transition: all 0.3s ease;
background: white;
position: relative;
overflow: hidden;
}

.platform-option:hover {
transform: translateY(-2px);
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.platform-option.selected {
border-color: #e91e63;
background: linear-gradient(135deg, #e91e63 0%, #f06292 100%);
color: white;
animation: platformGlow 2s infinite ease-in-out;
}

.platform-option.selected.multiple {
border-color: #4caf50;
background: linear-gradient(135deg, #4caf50 0%, #66bb6a 100%);
animation: multiGlow 2s infinite ease-in-out;
}

@keyframes platformGlow {
0%, 100% {
box-shadow: 0 0 20px rgba(233, 30, 99, 0.7);
}
50% {
box-shadow: 0 0 30px rgba(233, 30, 99, 1), 0 0 40px rgba(240, 98, 146, 0.8);
}
}

@keyframes multiGlow {
0%, 100% {
box-shadow: 0 0 20px rgba(76, 175, 80, 0.7);
}
50% {
box-shadow: 0 0 30px rgba(76, 175, 80, 1), 0 0 40px rgba(102, 187, 106, 0.8);
}
}

.platform-icon {
width: 35px;
height: 35px;
margin-bottom: 8px;
border-radius: 6px;
object-fit: cover;
transition: all 0.3s ease;
opacity: 1;
}

.platform-option.selected .platform-icon {
opacity: 1;
filter: brightness(1.2) contrast(1.1);
}

.platform-name {
font-size: 11px;
font-weight: 600;
text-align: center;
}

.platform-counter {
position: absolute;
top: 5px;
right: 5px;
background: #ff6b6b;
color: white;
border-radius: 50%;
width: 20px;
height: 20px;
display: none;
align-items: center;
justify-content: center;
font-size: 10px;
font-weight: bold;
}

.platform-option.selected .platform-counter {
display: flex;
}

/* File Upload */
.upload-area {
border: 3px dashed #ddd;
border-radius: 15px;
padding: 30px;
text-align: center;
cursor: pointer;
transition: all 0.3s ease;
background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
}

.upload-area:hover {
border-color: #1e3c72;
background: linear-gradient(135deg, #e3f2fd 0%, #f8f9fa 100%);
}

.upload-area.dragover {
border-color: #1e3c72;
background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
transform: scale(1.02);
}

.upload-icon {
font-size: 36px;
margin-bottom: 10px;
display: block;
}

.file-info {
display: none;
text-align: center;
padding: 20px;
background: #f8f9fa;
border-radius: 10px;
border: 2px solid #28a745;
}

.file-name {
font-weight: 600;
margin-bottom: 5px;
}

.remove-file {
background: #dc3545;
color: white;
border: none;
padding: 8px 16px;
border-radius: 5px;
cursor: pointer;
margin-top: 10px;
}

/* Scan Button - FIXED POSITIONING */
.scan-section {
text-align: center;
margin: 30px 0;
padding: 20px 0;
position: relative;
z-index: 10;
}

.scan-btn {
background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
color: white;
border: none;
padding: 15px 40px;
border-radius: 25px;
font-size: 18px;
font-weight: 600;
cursor: pointer;
transition: all 0.3s ease;
display: inline-flex;
align-items: center;
gap: 10px;
min-width: 200px;
justify-content: center;
position: relative;
z-index: 10;
}

.scan-btn:disabled {
background: #ccc;
cursor: not-allowed;
}

.scan-btn.ready {
background: linear-gradient(135deg, #1e3c72 0%, #667eea 100%);
box-shadow: 0 8px 25px rgba(30, 60, 114, 0.3);
}

.scan-btn.ready:hover {
transform: translateY(-2px);
box-shadow: 0 12px 35px rgba(30, 60, 114, 0.4);
}

.btn-loader {
display: none;
width: 20px;
height: 20px;
border: 2px solid transparent;
border-top: 2px solid white;
border-radius: 50%;
animation: spin 1s linear infinite;
}

.btn-loader.active {
display: block;
}

@keyframes spin {
0% { transform: rotate(0deg); }
100% { transform: rotate(360deg); }
}

/* Scan History Section */
.scan-history {
background: rgba(255, 255, 255, 0.95);
backdrop-filter: blur(10px);
border-radius: 20px;
padding: 25px;
margin-bottom: 20px;
box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
display: none;
}

.scan-history.visible {
display: block;
}

.history-filters {
display: flex;
gap: 10px;
margin-bottom: 20px;
flex-wrap: wrap;
}

.filter-btn {
padding: 8px 16px;
border: 2px solid #e0e0e0;
border-radius: 20px;
background: white;
cursor: pointer;
transition: all 0.3s ease;
font-size: 12px;
}

.filter-btn.active {
border-color: #1e3c72;
background: #1e3c72;
color: white;
}

.history-item {
display: flex;
align-items: center;
justify-content: space-between;
padding: 15px;
background: #f8f9fa;
border-radius: 10px;
margin-bottom: 10px;
transition: all 0.3s ease;
}

.history-item:hover {
background: #e3f2fd;
transform: translateX(5px);
}

.history-info {
display: flex;
align-items: center;
gap: 15px;
}

.history-platform {
width: 30px;
height: 30px;
border-radius: 6px;
}

.history-details h4 {
margin-bottom: 5px;
font-size: 14px;
}

.history-details p {
font-size: 12px;
color: #666;
}

.history-score {
font-size: 18px;
font-weight: bold;
color: #1e3c72;
}

/* Countries Modal */
.countries-modal {
display: none;
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0, 0, 0, 0.8);
z-index: 1000;
padding: 20px;
}

.countries-content {
background: white;
border-radius: 20px;
padding: 30px;
max-width: 600px;
max-height: 80vh;
margin: 50px auto;
overflow-y: auto;
position: relative;
}

.close-modal {
position: absolute;
top: 15px;
right: 20px;
background: none;
border: none;
font-size: 24px;
cursor: pointer;
color: #666;
}

.countries-grid {
display: grid;
grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
gap: 10px;
margin-top: 20px;
}

.country-item {
padding: 10px;
background: #f8f9fa;
border-radius: 8px;
text-align: center;
cursor: pointer;
transition: all 0.3s ease;
border: 2px solid transparent;
}

.country-item:hover {
background: #e3f2fd;
border-color: #1e3c72;
}

/* Results Section */
.results-section {
display: none;
margin-top: 30px;
margin-bottom: 50px;
}

.score-display {
display: flex;
align-items: center;
justify-content: center;
gap: 30px;
margin-bottom: 30px;
}

.score-circle {
width: 120px;
height: 120px;
border-radius: 50%;
background: conic-gradient(from 0deg, 
    #dc3545 0%, 
    #ffc107 calc(var(--score) * 0.4%), 
    #28a745 calc(var(--score) * 1%), 
    #e0e0e0 calc(var(--score) * 1%));
display: flex;
align-items: center;
justify-content: center;
position: relative;
box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
}

.score-circle::before {
content: '';
width: 80px;
height: 80px;
background: white;
border-radius: 50%;
position: absolute;
}

.score-value {
font-size: 24px;
font-weight: bold;
z-index: 1;
color: #333;
}

.status-indicator {
display: flex;
align-items: center;
gap: 10px;
font-size: 18px;
font-weight: 600;
}

.status-icon {
font-size: 24px;
}

.results-grid {
display: grid;
grid-template-columns: 1fr 1fr;
gap: 20px;
}

.issues-card, .recommendations-card {
background: white;
padding: 20px;
border-radius: 15px;
box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
}

.issue-item, .recommendation-item {
display: flex;
align-items: center;
gap: 10px;
padding: 10px;
margin-bottom: 10px;
background: #f8f9fa;
border-radius: 8px;
cursor: pointer;
transition: all 0.3s ease;
}

.issue-item:hover, .recommendation-item:hover {
background: #e3f2fd;
transform: translateX(5px);
}

/* Insight Modal */
.insight-modal {
display: none;
position: fixed;
top: 0;
left: 0;
width: 100%;
height: 100%;
background: rgba(0, 0, 0, 0.8);
z-index: 1000;
padding: 20px;
}

.insight-content {
background: white;
border-radius: 20px;
padding: 30px;
max-width: 500px;
margin: 50px auto;
position: relative;
}

.insight-content h3 {
margin-bottom: 20px;
color: #1e3c72;
}

/* Stats */
.stats-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
gap: 15px;
margin-bottom: 20px;
}

.stat-card {
background: rgba(255, 255, 255, 0.95);
backdrop-filter: blur(10px);
padding: 15px;
border-radius: 15px;
text-align: center;
box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
}

.stat-number {
font-size: 20px;
font-weight: bold;
color: #1e3c72;
margin-bottom: 5px;
}

.stat-label {
color: #666;
font-size: 12px;
}

/* Footer */
.footer {
text-align: center;
padding: 20px 0;
color: rgba(255, 255, 255, 0.8);
font-size: 14px;
margin-top: 40px;
}

/* Responsive */
@media (max-width: 1024px) {
.dashboard-grid {
grid-template-columns: 1fr 1fr;
}
}

@media (max-width: 768px) {
.dashboard-grid {
grid-template-columns: 1fr;
}
.platforms-grid {
grid-template-columns: repeat(2, 1fr);
}
.region-grid {
grid-template-columns: 1fr;
}
.tier-plans {
grid-template-columns: 1fr;
}
.score-display {
flex-direction: column;
gap: 20px;
}
}
</style>
</head>
<body>
<div class="container">
<!-- Header -->
<div class="header">
<div class="logo-section">
<img src="images/logo.png" alt="CheckReel Logo" class="logo-img">
<span class="logo-text">CheckReel</span>
</div>
<div class="user-section">
<span id="scansLeft">3 scans left</span>
<span id="tierBadge" class="tier-badge tier-free">Free Trial</span>
</div>
</div>

<!-- Tier Selection -->
<div class="tier-selection">
<h2 data-lang="choose-plan">🎯 Choose Your Plan</h2>
<div class="tier-plans">
<div class="tier-plan active" data-tier="free" onclick="selectTier('free')">
<div class="tier-name" data-lang="free-trial">Free Trial</div>
<div class="tier-price">$0</div>
<div class="tier-scans">3 scans</div>
<div class="tier-features" data-lang="basic-compliance">Basic compliance check<br>Standard results</div>
</div>
<div class="tier-plan recommended" data-tier="plus" onclick="selectTier('plus')">
<div class="tier-name" data-lang="plus-plan">Plus</div>
<div class="tier-price">$4.99/mo</div>
<div class="tier-scans">20 scans/month</div>
<div class="tier-features" data-lang="enhanced-compliance">Enhanced compliance check<br>Detailed insights<br>Scan history<br>Priority support</div>
</div>
<div class="tier-plan" data-tier="premium" onclick="selectTier('premium')">
<div class="tier-name" data-lang="premium-plan">Premium</div>
<div class="tier-price">$9.99/mo</div>
<div class="tier-scans">40 scans/month</div>
<div class="tier-features" data-lang="all-features">All features included<br>Advanced AI guidance for content optimization<br>Professional tool recommendations<br>Multiple platform scanning (max 3)<br>Comprehensive scan history & insights</div>
</div>
</div>
</div>

<!-- Selection Alert - MOVED BELOW TIER SELECTION -->
<div id="selectionAlert" class="selection-alert" data-lang="selection-alert">
⚠️ Please select a region and platform before uploading content for analysis
</div>

<!-- Scan History for Plus/Premium Users -->
<div id="scanHistory" class="scan-history">
<h2 data-lang="scan-history">📋 Scan History</h2>
<div class="history-filters">
<button class="filter-btn active" onclick="filterHistory('all')">All</button>
<button class="filter-btn" onclick="filterHistory('tiktok')">TikTok</button>
<button class="filter-btn" onclick="filterHistory('youtube')">YouTube</button>
<button class="filter-btn" onclick="filterHistory('instagram')">Instagram</button>
<button class="filter-btn" onclick="filterHistory('facebook')">Facebook</button>
<button class="filter-btn" onclick="filterHistory('twitter')">Twitter</button>
<button class="filter-btn" onclick="filterHistory('snapchat')">Snapchat</button>
</div>
<div id="historyList">
<!-- History items will be populated here -->
</div>
</div>

<!-- Main Dashboard -->
<div class="dashboard-grid">
<!-- Region Selection -->
<div class="card">
<h2 data-lang="select-region">🌍 Select Region</h2>
<div class="region-grid">
<div class="region-option" data-region="global" onclick="selectRegion('global')">
<img src="images/region-icons/global.png" alt="Global" class="region-icon"
onerror="this.outerHTML='<div style=&quot;width: 35px; height: 35px; background: #3498db; border-radius: 6px; margin-bottom: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px;&quot;>🌍</div>';">
<span class="region-name">Global</span>
</div>
<div class="region-option" data-region="middle-east" onclick="selectRegion('middle-east'); showCountries('middleEast')">
<img src="images/region-icons/middle-east.png" alt="Middle East" class="region-icon"
onerror="this.outerHTML='<div style=&quot;width: 35px; height: 35px; background: #e74c3c; border-radius: 6px; margin-bottom: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 10px;&quot;>ME</div>';">
<span class="region-name">Middle East</span>
</div>
<div class="region-option" data-region="mena" onclick="selectRegion('mena'); showCountries('mena')">
<img src="images/region-icons/mena.png" alt="MENA" class="region-icon"
onerror="this.outerHTML='<div style=&quot;width: 35px; height: 35px; background: #f39c12; border-radius: 6px; margin-bottom: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 10px;&quot;>MENA</div>';">
<span class="region-name">MENA</span>
</div>
<div class="region-option" data-region="europe" onclick="selectRegion('europe'); showCountries('europe')">
<img src="images/region-icons/europe.png" alt="Europe" class="region-icon"
onerror="this.outerHTML='<div style=&quot;width: 35px; height: 35px; background: #9b59b6; border-radius: 6px; margin-bottom: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 12px;&quot;>EU</div>';">
<span class="region-name">Europe</span>
</div>
</div>
</div>

<!-- Platform Selection -->
<div class="card">
<h2 data-lang="select-platform">📱 Select Platform</h2>
<div class="platforms-grid">
<div class="platform-option" data-platform="tiktok" onclick="selectPlatform('tiktok')">
<img src="images/tiktok.png" alt="TikTok" class="platform-icon"
onerror="this.outerHTML='<div style=&quot;width: 35px; height: 35px; background: #000; border-radius: 6px; margin-bottom: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 10px;&quot;>TT</div>';">
<span class="platform-name">TikTok</span>
<div class="platform-counter">1</div>
</div>
<div class="platform-option" data-platform="youtube" onclick="selectPlatform('youtube')">
<img src="images/youtube.png" alt="YouTube" class="platform-icon"
onerror="this.outerHTML='<div style=&quot;width: 35px; height: 35px; background: #ff0000; border-radius: 6px; margin-bottom: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 10px;&quot;>YT</div>';">
<span class="platform-name">YouTube</span>
<div class="platform-counter">2</div>
</div>
<div class="platform-option" data-platform="instagram" onclick="selectPlatform('instagram')">
<img src="images/instagram.png" alt="Instagram" class="platform-icon"
onerror="this.outerHTML='<div style=&quot;width: 35px; height: 35px; background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888); border-radius: 6px; margin-bottom: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 10px;&quot;>IG</div>';">
<span class="platform-name">Instagram</span>
<div class="platform-counter">3</div>
</div>
<div class="platform-option" data-platform="facebook" onclick="selectPlatform('facebook')">
<img src="images/facebook.png" alt="Facebook" class="platform-icon"
onerror="this.outerHTML='<div style=&quot;width: 35px; height: 35px; background: #1877f2; border-radius: 6px; margin-bottom: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 10px;&quot;>FB</div>';">
<span class="platform-name">Facebook</span>
<div class="platform-counter">1</div>
</div>
<div class="platform-option" data-platform="twitter" onclick="selectPlatform('twitter')">
<img src="images/twitter.png" alt="Twitter" class="platform-icon"
onerror="this.outerHTML='<div style=&quot;width: 35px; height: 35px; background: #1da1f2; border-radius: 6px; margin-bottom: 8px; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 10px;&quot;>TW</div>';">
<span class="platform-name">Twitter</span>
<div class="platform-counter">2</div>
</div>
<div class="platform-option" data-platform="snapchat" onclick="selectPlatform('snapchat')">
<img src="images/snapchat.png" alt="Snapchat" class="platform-icon"
onerror="this.outerHTML='<div style=&quot;width: 35px; height: 35px; background: #fffc00; border-radius: 6px; margin-bottom: 8px; display: flex; align-items: center; justify-content: center; color: black; font-weight: bold; font-size: 10px;&quot;>SC</div>';">
<span class="platform-name">Snapchat</span>
<div class="platform-counter">3</div>
</div>
</div>
</div>

<!-- File Upload -->
<div class="card">
<h2 data-lang="upload-content">📁 Upload Content</h2>
<div id="uploadArea" class="upload-area">
<span class="upload-icon">📤</span>
<h3 data-lang="drop-content">Drop your content here</h3>
<p data-lang="click-browse">or click to browse files</p>
<small data-lang="file-support">Supports: MP4, MOV, JPG, PNG, MP3, WAV (max 100MB)</small>
</div>
<div id="fileInfo" class="file-info">
<div class="file-name" id="fileName"></div>
<div class="file-size" id="fileSize"></div>
<button id="removeFile" class="remove-file">Remove File</button>
</div>
<input type="file" id="fileInput" style="display: none;" accept="video/*,image/*,audio/*">
</div>
</div>

<!-- Scan Button -->
<div class="scan-section">
<button id="scanBtn" class="scan-btn" disabled>
<span id="scan-btn-text" data-lang="start-content-check">Start Content Check</span>
<div id="btnLoader" class="btn-loader"></div>
</button>
</div>

<!-- Results Section -->
<div id="resultsSection" class="results-section">
<div class="card">
<h2 data-lang="compliance-results">📊 Compliance Results</h2>
<div class="score-display">
<div class="score-circle" style="--score: 85">
<span id="scoreValue" class="score-value">85</span>
</div>
<div class="status-indicator">
<span class="status-icon">✅</span>
<span id="status-text">Ready to Post</span>
</div>
</div>
<div class="results-grid">
<div class="issues-card">
<h3 data-lang="issues-found">⚠️ Issues Found</h3>
<div id="issuesList"></div>
</div>
<div class="recommendations-card">
<h3 data-lang="recommendations">💡 Recommendations</h3>
<div id="recommendationsList"></div>
</div>
</div>
</div>
</div>

<!-- Stats -->
<div class="stats-grid">
<div class="stat-card">
<div class="stat-number">2,697+</div>
<div class="stat-label" data-lang="active-users">Active Users</div>
</div>
<div class="stat-card">
<div class="stat-number">15,847</div>
<div class="stat-label" data-lang="content-scanned">Content Scanned</div>
</div>
<div class="stat-card">
<div class="stat-number">94%</div>
<div class="stat-label" data-lang="success-rate">Success Rate</div>
</div>
<div class="stat-card">
<div class="stat-number">6</div>
<div class="stat-label" data-lang="platforms">Platforms</div>
</div>
<div class="stat-card">
<div class="stat-number" id="scansUsedCounter">0</div>
<div class="stat-label" data-lang="scans-used">Scans Used (Testing)</div>
</div>
</div>="selectPlatform('instagram')">
<img src="images/instagram.png" alt="Instagram" class="platform-icon">
<span class="platform-name">Instagram</span>
<div class="platform-counter">3</div>
</div>
<div class="platform-option" data-platform="facebook" onclick="selectPlatform('facebook')">
<img src="images/facebook.png" alt="Facebook" class="platform-icon">
<span class="platform-name">Facebook</span>
<div class="platform-counter">1</div>
</div>
<div class="platform-option" data-platform="twitter" onclick="selectPlatform('twitter')">
<img src="images/twitter.png" alt="Twitter" class="platform-icon">
<span class="platform-name">Twitter</span>
<div class="platform-counter">2</div>
</div>
<div class="platform-option" data-platform="snapchat" onclick="selectPlatform('snapchat')">
<img src="images/snapchat.png" alt="Snapchat" class="platform-icon">
<span class="platform-name">Snapchat</span>
<div class="platform-counter">3</div>
</div>
</div>
</div>

<!-- File Upload -->
<div class="card">
<h2>📁 Upload Content</h2>
<div id="uploadArea" class="upload-area">
<span class="upload-icon">📤</span>
<h3>Drop your content here</h3>
<p>or click to browse files</p>
<small>Supports: MP4, MOV, JPG, PNG, MP3, WAV (max 100MB)</small>
</div>
<div id="fileInfo" class="file-info">
<div class="file-name" id="fileName"></div>
<div class="file-size" id="fileSize"></div>
<button id="removeFile" class="remove-file">Remove File</button>
</div>
<input type="file" id="fileInput" style="display: none;" accept="video/*,image/*,audio/*">
</div>
</div>

<!-- Scan Button -->
<div class="scan-section">
<button id="scanBtn" class="scan-btn" disabled>
<span id="scan-btn-text">Start Content Check</span>
<div id="btnLoader" class="btn-loader"></div>
</button>
</div>

<!-- Results Section -->
<div id="resultsSection" class="results-section">
<div class="card">
<h2>📊 Compliance Results</h2>
<div class="score-display">
<div class="score-circle" style="--score: 85">
<span id="scoreValue" class="score-value">85</span>
</div>
<div class="status-indicator">
<span class="status-icon">✅</span>
<span id="status-text">Ready to Post</span>
</div>
</div>
<div class="results-grid">
<div class="issues-card">
<h3>⚠️ Issues Found</h3>
<div id="issuesList"></div>
</div>
<div class="recommendations-card">
<h3>💡 Recommendations</h3>
<div id="recommendationsList"></div>
</div>
</div>
</div>
</div>

<!-- Stats -->
<div class="stats-grid">
<div class="stat-card">
<div class="stat-number">2,697+</div>
<div class="stat-label">Active Users</div>
</div>
<div class="stat-card">
<div class="stat-number">15,847</div>
<div class="stat-label">Content Scanned</div>
</div>
<div class="stat-card">
<div class="stat-number">94%</div>
<div class="stat-label">Success Rate</div>
</div>
<div class="stat-card">
<div class="stat-number">6</div>
<div class="stat-label">Platforms</div>
</div>
<div class="stat-card">
<div class="stat-number" id="scansUsedCounter">0</div>
<div class="stat-label">Scans Used (Testing)</div>
</div>
</div>

<!-- Countries Modal -->
<div id="countriesModal" class="countries-modal">
<div class="countries-content">
<button class="close-modal" onclick="closeCountriesModal()">&times;</button>
<h2 id="modalTitle">Select Country</h2>
<div id="countriesGrid" class="countries-grid"></div>
</div>
</div>

<!-- Insight Modal -->
<div id="insightModal" class="insight-modal">
<div class="insight-content">
<button class="close-modal" onclick="closeInsightModal()">&times;</button>
<h3 id="insightTitle">Insight Details</h3>
<div id="insightContent"></div>
</div>
</div>

<!-- Footer -->
<div class="footer">
<p>&copy; 2025 CheckReel. All rights reserved. Copyright Protected.</p>
</div>
</div>

<!-- Language Loader Script -->
<script>
// Language content loader for CheckReel Dashboard
const LANGUAGE_CONTENT = {
    en: {
        "page-title": "CheckReel Dashboard",
        "dashboard-title": "CheckReel Dashboard",
        "choose-plan": "🎯 Choose Your Plan",
        "free-trial": "Free Trial",
        "plus-plan": "Plus", 
        "premium-plan": "Premium",
        "basic-compliance": "Basic compliance check<br>Standard results",
        "enhanced-compliance": "Enhanced compliance check<br>Detailed insights<br>Scan history<br>Priority support",
        "all-features": "All features included<br>Advanced AI guidance for content optimization<br>Professional tool recommendations<br>Multiple platform scanning (max 3)<br>Comprehensive scan history & insights",
        "selection-alert": "⚠️ Please select a region and platform before uploading content for analysis",
        "scan-history": "📋 Scan History",
        "select-region": "🌍 Select Region",
        "select-platform": "📱 Select Platform", 
        "upload-content": "📁 Upload Content",
        "drop-content": "Drop your content here",
        "click-browse": "or click to browse files",
        "file-support": "Supports: MP4, MOV, JPG, PNG, MP3, WAV (max 100MB)",
        "start-content-check": "Start Content Check",
        "analyzing": "Analyzing...",
        "compliance-results": "📊 Compliance Results",
        "issues-found": "⚠️ Issues Found",
        "recommendations": "💡 Recommendations",
        "active-users": "Active Users",
        "content-scanned": "Content Scanned", 
        "success-rate": "Success Rate",
        "platforms": "Platforms",
        "scans-used": "Scans Used (Testing)"
    },
    fr: {
        "page-title": "Tableau de bord CheckReel",
        "dashboard-title": "Tableau de bord CheckReel", 
        "choose-plan": "🎯 Choisissez votre plan",
        "free-trial": "Essai gratuit",
        "plus-plan": "Plus",
        "premium-plan": "Premium", 
        "basic-compliance": "Vérification de conformité de base<br>Résultats standard",
        "enhanced-compliance": "Vérification de conformité améliorée<br>Informations détaillées<br>Historique des analyses<br>Support prioritaire",
        "all-features": "Toutes les fonctionnalités incluses<br>Conseils IA avancés pour l'optimisation du contenu<br>Recommandations d'outils professionnels<br>Analyse multi-plateforme (max 3)<br>Historique et informations complets",
        "selection-alert": "⚠️ Veuillez sélectionner une région et une plateforme avant de télécharger du contenu pour analyse",
        "scan-history": "📋 Historique des analyses",
        "select-region": "🌍 Sélectionner la région",
        "select-platform": "📱 Sélectionner la plateforme",
        "upload-content": "📁 Télécharger le contenu",
        "drop-content": "Déposez votre contenu ici",
        "click-browse": "ou cliquez pour parcourir les fichiers", 
        "file-support": "Supporte: MP4, MOV, JPG, PNG, MP3, WAV (max 100MB)",
        "start-content-check": "Commencer la vérification",
        "analyzing": "Analyse en cours...",
        "compliance-results": "📊 Résultats de conformité",
        "issues-found": "⚠️ Problèmes trouvés",
        "recommendations": "💡 Recommandations",
        "active-users": "Utilisateurs actifs",
        "content-scanned": "Contenu analysé",
        "success-rate": "Taux de réussite", 
        "platforms": "Plateformes",
        "scans-used": "Analyses utilisées (Test)"
    },
    ar: {
        "page-title": "لوحة تحكم تشيكريل",
        "dashboard-title": "لوحة تحكم تشيكريل",
        "choose-plan": "🎯 اختر خطتك", 
        "free-trial": "تجربة مجانية",
        "plus-plan": "بلس",
        "premium-plan": "بريميوم",
        "basic-compliance": "فحص امتثال أساسي<br>نتائج قياسية",
        "enhanced-compliance": "فحص امتثال محسن<br>رؤى مفصلة<br>سجل المسح<br>دعم أولوية",
        "all-features": "جميع الميزات مشمولة<br>إرشادات ذكية متقدمة لتحسين المحتوى<br>توصيات أدوات احترافية<br>مسح متعدد المنصات (الحد الأقصى 3)<br>سجل ورؤى شاملة للمسح",
        "selection-alert": "⚠️ يرجى تحديد منطقة ومنصة قبل رفع المحتوى للتحليل",
        "scan-history": "📋 سجل المسح",
        "select-region": "🌍 اختر المنطقة", 
        "select-platform": "📱 اختر المنصة",
        "upload-content": "📁 رفع المحتوى",
        "drop-content": "اسحب محتواك هنا",
        "click-browse": "أو انقر للتصفح",
        "file-support": "يدعم: MP4, MOV, JPG, PNG, MP3, WAV (الحد الأقصى 100 ميجابايت)",
        "start-content-check": "بدء فحص المحتوى", 
        "analyzing": "جاري التحليل...",
        "compliance-results": "📊 نتائج الامتثال",
        "issues-found": "⚠️ المشاكل الموجودة", 
        "recommendations": "💡 التوصيات",
        "active-users": "المستخدمون النشطون",
        "content-scanned": "المحتوى الممسوح",
        "success-rate": "معدل النجاح",
        "platforms": "المنصات", 
        "scans-used": "المسوحات المستخدمة (اختبار)"
    }
};

let dashboardLanguage = 'en';

async function loadLanguageFromFile(lang) {
    try {
        const response = await fetch(`data/${lang}.json`);
        if (response.ok) {
            return await response.json();
        }
    } catch (error) {
        console.warn(`Could not load ${lang}.json, using embedded content`);
    }
    return LANGUAGE_CONTENT[lang] || LANGUAGE_CONTENT.en;
}

function applyLanguageContent(content) {
    // Update page title
    if (content['page-title']) {
        document.title = content['page-title'];
    }
    
    // Apply content to elements with data-lang attributes and direct IDs
    Object.keys(content).forEach(key => {
        // Try direct ID match
        const element = document.getElementById(key);
        if (element) {
            if (element.tagName === 'INPUT' && element.type === 'submit') {
                element.value = content[key];
            } else if (element.tagName === 'INPUT') {
                element.placeholder = content[key];
            } else {
                element.innerHTML = content[key];
            }
        }
        
        // Try data-lang attribute match
        const langElements = document.querySelectorAll(`[data-lang="${key}"]`);
        langElements.forEach(el => {
            if (el.tagName === 'INPUT' && el.type === 'submit') {
                el.value = content[key];
            } else if (el.tagName === 'INPUT') {
                el.placeholder = content[key];
            } else {
                el.innerHTML = content[key];
            }
        });
    });
    
    updateSpecialElements(content);
}

function updateSpecialElements(content) {
    // Update tier features
    const freeFeatures = document.querySelector('[data-tier="free"] .tier-features');
    if (freeFeatures && content['basic-compliance']) {
        freeFeatures.innerHTML = content['basic-compliance'];
    }
    
    const plusFeatures = document.querySelector('[data-tier="plus"] .tier-features');
    if (plusFeatures && content['enhanced-compliance']) {
        plusFeatures.innerHTML = content['enhanced-compliance'];
    }
    
    const premiumFeatures = document.querySelector('[data-tier="premium"] .tier-features');
    if (premiumFeatures && content['all-features']) {
        premiumFeatures.innerHTML = content['all-features'];
    }
    
    // Update tier names
    const freeTitle = document.querySelector('[data-tier="free"] .tier-name');
    if (freeTitle && content['free-trial']) {
        freeTitle.textContent = content['free-trial'];
    }
    
    const plusTitle = document.querySelector('[data-tier="plus"] .tier-name');
    if (plusTitle && content['plus-plan']) {
        plusTitle.textContent = content['plus-plan'];
    }
    
    const premiumTitle = document.querySelector('[data-tier="premium"] .tier-name');
    if (premiumTitle && content['premium-plan']) {
        premiumTitle.textContent = content['premium-plan'];
    }
    
    updateActiveUsersCount(content);
}

function updateActiveUsersCount(content) {
    const activeUsersEl = document.querySelector('.stat-card .stat-number');
    if (!activeUsersEl) return;
    
    const baseCount = 2697;
    let userIncrement = localStorage.getItem('checkreel_user_increment');
    
    if (!userIncrement) {
        userIncrement = Math.floor(Math.random() * 100) + 1;
        localStorage.setItem('checkreel_user_increment', userIncrement.toString());
    }
    
    const totalUsers = baseCount + parseInt(userIncrement);
    activeUsersEl.textContent = `${totalUsers.toLocaleString()}+`;
}

async function loadLanguageContent(lang) {
    dashboardLanguage = lang;
    
    try {
        const content = await loadLanguageFromFile(lang);
        applyLanguageContent(content);
        
        localStorage.setItem('checkreel_language', lang);
        document.documentElement.lang = lang;
        
        if (lang === 'ar') {
            document.body.setAttribute('dir', 'rtl');
            document.documentElement.setAttribute('dir', 'rtl');
        } else {
            document.body.removeAttribute('dir');
            document.documentElement.removeAttribute('dir');
        }
        
    } catch (error) {
        console.error('Failed to load language content:', error);
        if (lang !== 'en') {
            loadLanguageContent('en');
        }
    }
}

// Initialize language on page load
document.addEventListener('DOMContentLoaded', function() {
    const savedLang = localStorage.getItem('checkreel_language') || 'en';
    loadLanguageContent(savedLang);
});

// Make language functions globally available
window.loadLanguageContent = loadLanguageContent;
window.LANGUAGE_CONTENT = LANGUAGE_CONTENT;
</script>

<script>
// Global variables
let selectedFile = null;
let selectedPlatforms = []; // Changed to array for multi-platform support
let selectedRegion = null;
let selectedCountry = null;
let currentTier = 'free';

// Load language from homepage and initialize dashboard
document.addEventListener('DOMContentLoaded', function() {
    const savedLanguage = localStorage.getItem('checkreel_language') || 'en';
    console.log('Dashboard loaded with language:', savedLanguage);
    
    // Initialize all dashboard components
    initializeUpload();
    updateTierDisplay();
    updateUserCounter();
    updateScansCounter();
    updateScanHistory();
    
    // Load language content (will be loaded by the embedded language loader)
    setTimeout(() => {
        if (typeof loadLanguageContent === 'function') {
            loadLanguageContent(savedLanguage);
        }
    }, 100);
});

// Countries data
const countriesData = {
middleEast: [
'Palestine', 'Jordan', 'Lebanon', 'Syria', 'Iraq', 'Kuwait', 'Saudi Arabia',
'Bahrain', 'Qatar', 'United Arab Emirates', 'Oman', 'Yemen', 'Iran', 'Turkey', 'Cyprus'
],
mena: [
'Palestine', 'Jordan', 'Lebanon', 'Syria', 'Iraq', 'Kuwait', 'Saudi Arabia',
'Bahrain', 'Qatar', 'United Arab Emirates', 'Oman', 'Yemen', 'Iran', 'Turkey',
'Egypt', 'Libya', 'Tunisia', 'Algeria', 'Morocco', 'Sudan', 'Mauritania', 'Djibouti', 'Somalia'
],
europe: [
'Albania', 'Andorra', 'Armenia', 'Austria', 'Azerbaijan', 'Belarus', 'Belgium',
'Bosnia and Herzegovina', 'Bulgaria', 'Croatia', 'Cyprus', 'Czech Republic',
'Denmark', 'Estonia', 'Finland', 'France', 'Georgia', 'Germany', 'Greece',
'Hungary', 'Iceland', 'Ireland', 'Italy', 'Kazakhstan', 'Kosovo', 'Latvia',
'Liechtenstein', 'Lithuania', 'Luxembourg', 'Malta', 'Moldova', 'Monaco',
'Montenegro', 'Netherlands', 'North Macedonia', 'Norway', 'Poland', 'Portugal',
'Romania', 'Russia', 'San Marino', 'Serbia', 'Slovakia', 'Slovenia', 'Spain',
'Sweden', 'Switzerland', 'Ukraine', 'United Kingdom', 'Vatican City'
]
};

// Initialize dashboard
document.addEventListener('DOMContentLoaded', function() {
// Remove duplicate - initialization is now handled above
});

// Tier selection
function selectTier(tier) {
currentTier = tier;
localStorage.setItem('checkreel_tier', tier);
// Update visual selection
document.querySelectorAll('.tier-plan').forEach(plan => {
plan.classList.remove('active');
});
document.querySelector(`[data-tier="${tier}"]`).classList.add('active');
// Reset scans if upgrading
if (tier !== 'free') {
localStorage.setItem('checkreel_scans_used', '0');
}
updateTierDisplay();
updateScansCounter();
updateScanHistory();
}

// Region selection
function selectRegion(region) {
selectedRegion = region;
// Remove previous selection
document.querySelectorAll('.region-option').forEach(opt => opt.classList.remove('selected'));
// Add selection to clicked option
document.querySelector(`[data-region="${region}"]`).classList.add('selected');
updateScanButton();
updateSelectionAlert();
}

// Platform selection - Enhanced for multi-platform support
function selectPlatform(platform) {
const currentTier = localStorage.getItem('checkreel_tier') || 'free';
const platformElement = document.querySelector(`[data-platform="${platform}"]`);
const counter = platformElement.querySelector('.platform-counter');
const isSelected = selectedPlatforms.includes(platform);

if (currentTier === 'premium') {
// Premium users can select up to 3 platforms
if (isSelected) {
// Remove platform
selectedPlatforms = selectedPlatforms.filter(p => p !== platform);
platformElement.classList.remove('selected', 'multiple');
} else {
// Add platform (max 3)
if (selectedPlatforms.length < 3) {
selectedPlatforms.push(platform);
platformElement.classList.add('selected');
if (selectedPlatforms.length > 1) {
platformElement.classList.add('multiple');
}
} else {
alert('Premium users can select maximum 3 platforms per scan');
return;
}
}
} else {
// Free and Plus users can only select one platform
selectedPlatforms = [platform];
document.querySelectorAll('.platform-option').forEach(opt => {
opt.classList.remove('selected', 'multiple');
});
platformElement.classList.add('selected');
}

// Update counter display
updatePlatformCounters();
updateScanButton();
updateSelectionAlert();
}

function updatePlatformCounters() {
document.querySelectorAll('.platform-option').forEach((option, index) => {
const counter = option.querySelector('.platform-counter');
const platform = option.dataset.platform;
const platformIndex = selectedPlatforms.indexOf(platform);

if (platformIndex !== -1) {
counter.textContent = platformIndex + 1;
counter.style.display = 'flex';
} else {
counter.style.display = 'none';
}
});
}

// Countries modal
function showCountries(region) {
const modal = document.getElementById('countriesModal');
const grid = document.getElementById('countriesGrid');
const title = document.getElementById('modalTitle');
title.textContent = `Select Country - ${region.charAt(0).toUpperCase() + region.slice(1)}`;
grid.innerHTML = '';
countriesData[region].forEach(country => {
const item = document.createElement('div');
item.className = 'country-item';
item.textContent = country;
item.onclick = () => selectCountry(country);
grid.appendChild(item);
});
modal.style.display = 'block';
}

function selectCountry(country) {
selectedCountry = country;
closeCountriesModal();
console.log('Selected country:', country);
}

function closeCountriesModal() {
document.getElementById('countriesModal').style.display = 'none';
}

// Update selection alert
function updateSelectionAlert() {
const alert = document.getElementById('selectionAlert');
if (selectedRegion && selectedPlatforms.length > 0) {
alert.classList.add('hidden');
} else {
alert.classList.remove('hidden');
}
}

// Scan History Management
function updateScanHistory() {
const currentTier = localStorage.getItem('checkreel_tier') || 'free';
const historySection = document.getElementById('scanHistory');

if (currentTier === 'plus' || currentTier === 'premium') {
historySection.classList.add('visible');
loadScanHistory();
} else {
historySection.classList.remove('visible');
}
}

function loadScanHistory() {
const historyList = document.getElementById('historyList');
const scanHistory = JSON.parse(localStorage.getItem('checkreel_scan_history') || '[]');

if (scanHistory.length === 0) {
historyList.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">No scan history yet. Start scanning to see your results here!</p>';
return;
}

historyList.innerHTML = '';
scanHistory.forEach(scan => {
const historyItem = document.createElement('div');
historyItem.className = 'history-item';
historyItem.innerHTML = `
<div class="history-info">
<img src="images/${scan.platform}.png" alt="${scan.platform}" class="history-platform">
<div class="history-details">
<h4>${scan.filename}</h4>
<p>${scan.region} • ${scan.platform} • ${scan.date}</p>
</div>
</div>
<div class="history-score">${scan.score}</div>
`;
historyList.appendChild(historyItem);
});
}

function filterHistory(platform) {
document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
event.target.classList.add('active');

const historyItems = document.querySelectorAll('.history-item');
historyItems.forEach(item => {
const itemPlatform = item.querySelector('.history-platform').alt;
if (platform === 'all' || itemPlatform === platform) {
item.style.display = 'flex';
} else {
item.style.display = 'none';
}
});
}

// File upload functionality
function initializeUpload() {
const uploadArea = document.getElementById('uploadArea');
const fileInput = document.getElementById('fileInput');
const fileInfo = document.getElementById('fileInfo');
const removeFileBtn = document.getElementById('removeFile');

if (!uploadArea || !fileInput) return;

// Click to browse
uploadArea.addEventListener('click', () => {
if (!selectedRegion || selectedPlatforms.length === 0) {
alert('Please select a region and platform first!');
return;
}
fileInput.click();
});

// File input change
fileInput.addEventListener('change', (e) => {
const file = e.target.files[0];
if (file && selectedRegion && selectedPlatforms.length > 0) {
handleFileSelect(file);
}
});

// Drag and drop
uploadArea.addEventListener('dragover', (e) => {
e.preventDefault();
if (selectedRegion && selectedPlatforms.length > 0) {
uploadArea.classList.add('dragover');
}
});

uploadArea.addEventListener('dragleave', (e) => {
e.preventDefault();
uploadArea.classList.remove('dragover');
});

uploadArea.addEventListener('drop', (e) => {
e.preventDefault();
uploadArea.classList.remove('dragover');
if (!selectedRegion || selectedPlatforms.length === 0) {
alert('Please select a region and platform first!');
return;
}
const file = e.dataTransfer.files[0];
if (file) {
handleFileSelect(file);
}
});

// Remove file
if (removeFileBtn) {
removeFileBtn.addEventListener('click', (e) => {
e.stopPropagation();
clearSelectedFile();
});
}
}

function handleFileSelect(file) {
// Validate file type
const allowedTypes = ['video/mp4', 'video/quicktime', 'image/jpeg', 'image/png', 'audio/mp3', 'audio/wav', 'audio/opus'];
if (!allowedTypes.includes(file.type)) {
alert('Unsupported file type. Please select MP4, MOV, JPG, PNG, MP3, or WAV files.');
return;
}

// Validate file size (100MB limit)
const maxSize = 100 * 1024 * 1024; // 100MB in bytes
if (file.size > maxSize) {
alert('File size too large. Please select a file smaller than 100MB.');
return;
}

selectedFile = file;
displayFileInfo(file);
updateScanButton();
}

function displayFileInfo(file) {
const uploadArea = document.getElementById('uploadArea');
const fileInfo = document.getElementById('fileInfo');
const fileName = document.getElementById('fileName');
const fileSize = document.getElementById('fileSize');

if (fileName) fileName.textContent = file.name;
if (fileSize) fileSize.textContent = formatFileSize(file.size);
if (uploadArea) uploadArea.style.display = 'none';
if (fileInfo) fileInfo.style.display = 'block';
}

function clearSelectedFile() {
const uploadArea = document.getElementById('uploadArea');
const fileInfo = document.getElementById('fileInfo');
const fileInput = document.getElementById('fileInput');

selectedFile = null;
if (fileInput) fileInput.value = '';
if (uploadArea) uploadArea.style.display = 'block';
if (fileInfo) fileInfo.style.display = 'none';
updateScanButton();
}

function formatFileSize(bytes) {
if (bytes === 0) return '0 Bytes';
const k = 1024;
const sizes = ['Bytes', 'KB', 'MB', 'GB'];
const i = Math.floor(Math.log(bytes) / Math.log(k));
return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

function updateScanButton() {
const scanBtn = document.getElementById('scanBtn');
if (!scanBtn) return;

const canScan = selectedFile && selectedPlatforms.length > 0 && selectedRegion;
scanBtn.disabled = !canScan;

if (canScan) {
scanBtn.classList.add('ready');
} else {
scanBtn.classList.remove('ready');
}
}

// Scan functionality
document.addEventListener('DOMContentLoaded', function() {
const scanBtn = document.getElementById('scanBtn');
if (scanBtn) {
scanBtn.addEventListener('click', async function() {
if (!selectedFile || selectedPlatforms.length === 0 || !selectedRegion) return;

// Check if user has scans remaining
if (!checkScanLimit()) {
alert('You have reached your scan limit! Please upgrade your plan.');
return;
}

await performScan();
});
}
});

function checkScanLimit() {
const userTier = localStorage.getItem('checkreel_tier') || 'free';
const scansUsed = parseInt(localStorage.getItem('checkreel_scans_used') || '0');
const limits = {
free: 3,
plus: 20,
premium: 40
};
return scansUsed < limits[userTier];
}

async function performScan() {
const scanBtn = document.getElementById('scanBtn');
const btnText = document.getElementById('scan-btn-text');
const btnLoader = document.getElementById('btnLoader');
const resultsSection = document.getElementById('resultsSection');

if (!scanBtn) return;

// Get current language for button text
const currentLang = localStorage.getItem('checkreel_language') || 'en';
const analyzingText = {
    'en': 'Analyzing...',
    'fr': 'Analyse en cours...',
    'ar': 'جاري التحليل...'
};

// Update button state
scanBtn.disabled = true;
if (btnText) btnText.textContent = analyzingText[currentLang] || 'Analyzing...';
if (btnLoader) btnLoader.classList.add('active');

try {
// Simulate scan process
await new Promise(resolve => setTimeout(resolve, 3000));

// Generate results based on issue severity
const results = generateEnhancedResults();

// Display results
displayResults(results);

// Save to scan history for Plus/Premium users
saveScanToHistory(results);

// Increment scan count (ACTIVE for testing)
incrementScanCount();

// Update displays
updateTierDisplay();
updateScansCounter();
updateScanHistory();

// Scroll to results
if (resultsSection) {
resultsSection.scrollIntoView({ behavior: 'smooth' });
}

} catch (error) {
console.error('Scan error:', error);
alert('An error occurred during scanning. Please try again.');
} finally {
// Reset button state with correct language
const startText = {
    'en': 'Start Content Check',
    'fr': 'Commencer la vérification',
    'ar': 'بدء فحص المحتوى'
};
scanBtn.disabled = false;
if (btnText) btnText.textContent = startText[currentLang] || 'Start Content Check';
if (btnLoader) btnLoader.classList.remove('active');
}
}

function generateEnhancedResults() {
const userTier = localStorage.getItem('checkreel_tier') || 'free';
const score = 70 + Math.floor(Math.random() * 31); // 70-100

// Dynamic status based on severity
let status, statusIcon;
if (score >= 90) {
status = 'Excellent - Ready to Post';
statusIcon = '🌟';
} else if (score >= 80) {
status = 'Ready to Post';
statusIcon = '✅';
} else if (score >= 70) {
status = 'Minor Issues - Review Recommended';
statusIcon = '⚠️';
} else if (score >= 60) {
status = 'Needs Attention';
statusIcon = '🔴';
} else {
status = 'Significant Issues Found';
statusIcon = '❌';
}

let issues, recommendations;

if (userTier === 'free') {
issues = [
{ icon: '⚠️', text: `Basic compliance check for ${selectedPlatforms[0]}` }
];
recommendations = [
{ icon: '💡', text: `Consider upgrading for detailed insights` }
];
} else if (userTier === 'plus') {
issues = [
{ icon: '⚠️', text: `Audio levels need adjustment for ${selectedPlatforms[0]}` },
{ icon: '📺', text: `Content may not fully align with ${selectedRegion} guidelines` }
];
recommendations = [
{ icon: '📈', text: `Use trending hashtags for ${selectedPlatforms[0]}` },
{ icon: '⏰', text: `Optimal posting time for ${selectedRegion}: 7-9 PM` }
];
} else { // premium
issues = [
{ icon: '⚠️', text: `Audio levels: Consider professional audio enhancement tools` },
{ icon: '📺', text: `Visual quality: Enhance graphics with professional design tools` },
{ icon: '🎬', text: `Video enhancement: Use professional video editing tools for better effects` }
];
recommendations = [
{ icon: '🤖', text: `AI Analysis suggests: Adjust content pacing for ${selectedPlatforms.join(', ')}` },
{ icon: '💬', text: `Advanced AI recommends: Improve engagement hooks` },
{ icon: '🛠️', text: `Professional Tools: Enhanced graphics, audio optimization, and video effects available` }
];
}

return {
score: score,
status: status,
statusIcon: statusIcon,
issues: issues,
recommendations: recommendations
};
}

function saveScanToHistory(results) {
const currentTier = localStorage.getItem('checkreel_tier') || 'free';
if (currentTier === 'free') return;

const scanHistory = JSON.parse(localStorage.getItem('checkreel_scan_history') || '[]');
const newScan = {
filename: selectedFile.name,
platform: selectedPlatforms.join(', '),
region: selectedRegion,
score: results.score,
date: new Date().toLocaleDateString(),
status: results.status
};

scanHistory.unshift(newScan); // Add to beginning
if (scanHistory.length > 50) scanHistory.pop(); // Keep last 50 scans

localStorage.setItem('checkreel_scan_history', JSON.stringify(scanHistory));
}

function displayResults(results) {
const resultsSection = document.getElementById('resultsSection');
const scoreValue = document.getElementById('scoreValue');
const statusText = document.getElementById('status-text');
const statusIcon = document.querySelector('.status-icon');
const issuesList = document.getElementById('issuesList');
const recommendationsList = document.getElementById('recommendationsList');
const scoreCircle = document.querySelector('.score-circle');

// Update score
if (scoreValue) scoreValue.textContent = results.score;
if (scoreCircle) scoreCircle.style.setProperty('--score', results.score);

// Update status
if (statusText) statusText.textContent = results.status;
if (statusIcon) statusIcon.textContent = results.statusIcon;

// Update issues with click handlers
if (issuesList) {
issuesList.innerHTML = '';
results.issues.forEach((issue, index) => {
const item = document.createElement('div');
item.className = 'issue-item';
item.innerHTML = `
<span class="issue-icon">${issue.icon}</span>
<span>${issue.text}</span>
`;
item.onclick = () => showInsight('issue', issue, index);
issuesList.appendChild(item);
});
}

// Update recommendations with click handlers
if (recommendationsList) {
recommendationsList.innerHTML = '';
results.recommendations.forEach((rec, index) => {
const item = document.createElement('div');
item.className = 'recommendation-item';
item.innerHTML = `
<span class="recommendation-icon">${rec.icon}</span>
<span>${rec.text}</span>
`;
item.onclick = () => showInsight('recommendation', rec, index);
recommendationsList.appendChild(item);
});
}

if (resultsSection) resultsSection.style.display = 'block';
}

function showInsight(type, item, index) {
const modal = document.getElementById('insightModal');
const title = document.getElementById('insightTitle');
const content = document.getElementById('insightContent');

title.textContent = type === 'issue' ? 'Issue Details' : 'Recommendation Details';

// Generate detailed insights based on tier
const userTier = localStorage.getItem('checkreel_tier') || 'free';
let detailedContent = '';

if (userTier === 'premium' && type === 'recommendation') {
detailedContent = `
<p><strong>Advanced AI Analysis:</strong></p>
<p>${item.text}</p>
<br>
<p><strong>Professional Tools Available:</strong></p>
<ul>
<li>🎨 <strong>Graphics Enhancement:</strong> Professional design tools for better visuals</li>
<li>🎙️ <strong>Audio Improvement:</strong> Advanced voice enhancement and audio quality tools</li>
<li>🎬 <strong>Video Optimization:</strong> Professional video effects and enhancement tools</li>
<li>✨ <strong>Content Analysis:</strong> Advanced AI-powered content optimization</li>
</ul>
<br>
<p><strong>AI Guidance:</strong> This analysis uses advanced AI technology with dynamic optimization for optimal performance and accuracy.</p>
`;
} else {
detailedContent = `
<p><strong>Details:</strong></p>
<p>${item.text}</p>
<br>
<p>Upgrade to Premium for advanced AI tool recommendations and detailed insights.</p>
`;
}

content.innerHTML = detailedContent;
modal.style.display = 'block';
}

function closeInsightModal() {
document.getElementById('insightModal').style.display = 'none';
}

function incrementScanCount() {
const currentCount = parseInt(localStorage.getItem('checkreel_scans_used') || '0');
localStorage.setItem('checkreel_scans_used', (currentCount + 1).toString());
}

// Tier management
function updateTierDisplay() {
const userTier = localStorage.getItem('checkreel_tier') || 'free';
const scansUsed = parseInt(localStorage.getItem('checkreel_scans_used') || '0');
const tierData = {
free: { name: 'Free Trial', scans: 3, class: 'tier-free' },
plus: { name: 'Plus', scans: 20, class: 'tier-plus' },
premium: { name: 'Premium', scans: 40, class: 'tier-premium' }
};

const tier = tierData[userTier];
const scansLeft = Math.max(0, tier.scans - scansUsed);
const tierBadge = document.getElementById('tierBadge');
const scansLeftEl = document.getElementById('scansLeft');

if (tierBadge) {
tierBadge.textContent = tier.name;
tierBadge.className = `tier-badge ${tier.class}`;
}

if (scansLeftEl) {
scansLeftEl.textContent = `${scansLeft} scans left`;
}
}

function updateUserCounter() {
const baseCount = 2697;
let userIncrement = localStorage.getItem('checkreel_user_increment');
if (!userIncrement) {
userIncrement = Math.floor(Math.random() * 100) + 1;
localStorage.setItem('checkreel_user_increment', userIncrement.toString());
}
const totalUsers = baseCount + parseInt(userIncrement);

// Update stats if they exist
const activeUsersEl = document.getElementById('active-users');
if (activeUsersEl) {
activeUsersEl.textContent = `🔥 ${totalUsers.toLocaleString()} active users`;
}
}

function updateScansCounter() {
const scansUsed = parseInt(localStorage.getItem('checkreel_scans_used') || '0');
const counterEl = document.getElementById('scansUsedCounter');
if (counterEl) {
counterEl.textContent = scansUsed;
}
}

// Make functions globally available
window.selectTier = selectTier;
window.selectRegion = selectRegion;
window.selectPlatform = selectPlatform;
window.showCountries = showCountries;
window.closeCountriesModal = closeCountriesModal;
window.selectCountry = selectCountry;
window.showInsight = showInsight;
window.closeInsightModal = closeInsightModal;
window.filterHistory = filterHistory;

// Close modals when clicking outside
window.addEventListener('click', function(e) {
const countriesModal = document.getElementById('countriesModal');
const insightModal = document.getElementById('insightModal');
if (e.target === countriesModal) {
closeCountriesModal();
}
if (e.target === insightModal) {
closeInsightModal();
}
});
</script>
</body>
</html>